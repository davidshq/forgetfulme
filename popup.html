<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ForgetfulMe</title>
    <link rel="stylesheet" href="assets/libs/pico.min.css" />
    <link rel="stylesheet" href="assets/styles/shared-styles.css" />
    <link rel="stylesheet" href="assets/styles/shared-modal-styles.css" />
    <link rel="stylesheet" href="assets/styles/popup-styles.css" />
  </head>
  <body>
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <main id="main-content" class="container">
      <!-- Static semantic structure for accessibility -->
      <header>
        <h1 id="app-title">ForgetfulMe</h1>
        <nav aria-label="Extension actions" id="app-navigation">
          <!-- Navigation will be enhanced by JS -->
        </nav>
      </header>

      <section id="main-interface" aria-labelledby="main-heading">
        <h2 id="main-heading" class="sr-only">Main Interface</h2>
        <!-- Dynamic content loads here -->
        <div id="loading-indicator" aria-live="polite">
          <progress>Loading...</progress>
          <p>Loading ForgetfulMe...</p>
        </div>
      </section>

      <section id="auth-interface" aria-labelledby="auth-heading" hidden>
        <h2 id="auth-heading">Authentication Required</h2>

        <!-- Login Form -->
        <div id="login-container" class="auth-container">
          <header class="auth-header">
            <h3>Sign in to ForgetfulMe</h3>
            <p>Access your bookmarks across all devices</p>
          </header>

          <form id="loginForm">
            <fieldset>
              <label for="loginEmail">Email</label>
              <input
                type="email"
                id="loginEmail"
                name="email"
                placeholder="Enter your email"
                required
                aria-describedby="loginEmail-error"
              />
              <small
                id="loginEmail-error"
                class="error-text"
                role="alert"
              ></small>
            </fieldset>

            <fieldset>
              <label for="loginPassword">Password</label>
              <input
                type="password"
                id="loginPassword"
                name="password"
                placeholder="Enter your password"
                required
                aria-describedby="loginPassword-error"
              />
              <small
                id="loginPassword-error"
                class="error-text"
                role="alert"
              ></small>
            </fieldset>

            <button type="submit">Sign In</button>
          </form>

          <div class="auth-footer">
            <p>
              Don't have an account? <a href="#" id="showSignup">Sign up</a>
            </p>
          </div>

          <div
            id="authMessage"
            class="auth-message"
            role="alert"
            aria-live="polite"
          ></div>
        </div>

        <!-- Signup Form -->
        <div id="signup-container" class="auth-container" hidden>
          <header class="auth-header">
            <h3>Create Account</h3>
            <p>Start organizing your bookmarks with ForgetfulMe</p>
          </header>

          <form id="signupForm">
            <fieldset>
              <label for="signupEmail">Email</label>
              <input
                type="email"
                id="signupEmail"
                name="email"
                placeholder="Enter your email"
                required
                aria-describedby="signupEmail-error"
              />
              <small
                id="signupEmail-error"
                class="error-text"
                role="alert"
              ></small>
            </fieldset>

            <fieldset>
              <label for="signupPassword">Password</label>
              <input
                type="password"
                id="signupPassword"
                name="password"
                placeholder="Create a password"
                required
                aria-describedby="signupPassword-help signupPassword-error"
              />
              <small id="signupPassword-help" class="help-text"
                >Password must be at least 6 characters</small
              >
              <small
                id="signupPassword-error"
                class="error-text"
                role="alert"
              ></small>
            </fieldset>

            <fieldset>
              <label for="confirmPassword">Confirm Password</label>
              <input
                type="password"
                id="confirmPassword"
                name="confirmPassword"
                placeholder="Confirm your password"
                required
                aria-describedby="confirmPassword-error"
              />
              <small
                id="confirmPassword-error"
                class="error-text"
                role="alert"
              ></small>
            </fieldset>

            <button type="submit">Create Account</button>
          </form>

          <div class="auth-footer">
            <p>
              Already have an account? <a href="#" id="showLogin">Sign in</a>
            </p>
          </div>

          <div
            id="authMessageSignup"
            class="auth-message"
            role="alert"
            aria-live="polite"
          ></div>
        </div>

        <!-- User Profile Display -->
        <div id="profile-container" class="auth-container" hidden>
          <div class="user-profile">
            <div class="profile-header">
              <h3>Welcome back!</h3>
              <p id="user-email">Signed in as user@example.com</p>
            </div>

            <div class="profile-actions">
              <button id="signOutBtn" class="secondary">Sign Out</button>
            </div>
          </div>
        </div>
      </section>

      <section id="setup-interface" aria-labelledby="setup-heading" hidden>
        <h2 id="setup-heading">Setup Required</h2>
        <p>Configuration needed to connect to your data storage.</p>
        <!-- Setup content loads here -->
      </section>

      <section id="error-interface" aria-labelledby="error-heading" hidden>
        <h2 id="error-heading">Error</h2>
        <p id="error-message">
          An unexpected error occurred. Please try again.
        </p>
        <!-- Error content loads here -->
      </section>
    </main>

    <!-- ARIA live region for announcements -->
    <div
      id="status-announcements"
      aria-live="polite"
      aria-atomic="true"
      class="sr-only"
    ></div>

    <!-- Load Supabase library -->
    <script src="supabase-js.min.js"></script>
    <!-- Load main popup script -->
    <script src="popup.js" type="module"></script>
  </body>
</html>
