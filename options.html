<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ForgetfulMe Settings</title>
    <link rel="stylesheet" href="libs/pico.min.css" />
    <link rel="stylesheet" href="shared-styles.css" />
    <link rel="stylesheet" href="shared-modal-styles.css" />
    <link rel="stylesheet" href="options-styles.css" />
  </head>
  <body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <main id="main-content" class="container">
      <!-- Static semantic structure for accessibility -->
      <header>
        <h1 id="page-title">ForgetfulMe Settings</h1>
        <p id="page-description">Configure your ForgetfulMe extension preferences and data storage.</p>
      </header>
      
      <section id="config-interface" aria-labelledby="config-heading">
        <h2 id="config-heading">Database Configuration</h2>
        <p>Connect ForgetfulMe to your Supabase database to sync your bookmarks across devices.</p>
        
        <!-- Configuration Form -->
        <div id="config-form-container" class="config-container">
          <header class="config-header">
            <h3>Supabase Configuration</h3>
            <p>Enter your Supabase project credentials to enable cloud sync</p>
          </header>
          
          <form id="configForm">
            <fieldset>
              <label for="supabaseUrl">Project URL</label>
              <input 
                type="url" 
                id="supabaseUrl" 
                name="url" 
                placeholder="https://your-project.supabase.co" 
                required 
                aria-describedby="supabaseUrl-help supabaseUrl-error"
              />
              <small id="supabaseUrl-help" class="help-text">Your Supabase project URL (found in Settings > API)</small>
              <small id="supabaseUrl-error" class="error-text" role="alert"></small>
            </fieldset>
            
            <fieldset>
              <label for="supabaseAnonKey">Anon Public Key</label>
              <input 
                type="text" 
                id="supabaseAnonKey" 
                name="anonKey" 
                placeholder="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." 
                required 
                aria-describedby="supabaseAnonKey-help supabaseAnonKey-error"
              />
              <small id="supabaseAnonKey-help" class="help-text">Your anon public key (found in Settings > API)</small>
              <small id="supabaseAnonKey-error" class="error-text" role="alert"></small>
            </fieldset>
            
            <button type="submit">Save Configuration</button>
          </form>
          
          <div class="config-help">
            <h4>How to get your credentials:</h4>
            <ol>
              <li>Go to <a href="https://supabase.com" target="_blank" rel="noopener">supabase.com</a> and create an account</li>
              <li>Create a new project</li>
              <li>Go to Settings > API in your project dashboard</li>
              <li>Copy the "Project URL" and "anon public" key</li>
              <li>Paste them in the form above</li>
            </ol>
            
            <div class="config-note">
              <strong>Note:</strong> Your credentials are stored securely in your browser's sync storage and are never shared with anyone.
            </div>
          </div>
          
          <div id="configMessage" class="config-message" role="alert" aria-live="polite"></div>
        </div>
        
        <!-- Configuration Status Display -->
        <div id="config-status-container" class="config-container" hidden>
          <div class="config-status">
            <h3>Configuration Status</h3>
            <div class="status-item">
              <span class="status-label">Supabase URL:</span>
              <span class="status-value" id="statusUrl">-</span>
            </div>
            <div class="status-item">
              <span class="status-label">Anon Key:</span>
              <span class="status-value" id="statusKey">-</span>
            </div>
            <div class="status-item">
              <span class="status-label">Connection:</span>
              <span class="status-value" id="statusConnection">-</span>
            </div>
            
            <div class="status-actions">
              <button id="testConnectionBtn" class="secondary">Test Connection</button>
              <button id="editConfigBtn" class="secondary">Edit Configuration</button>
            </div>
          </div>
        </div>
        
        <div id="config-loading" aria-live="polite" hidden>
          <progress>Loading configuration...</progress>
        </div>
      </section>
      
      <section id="auth-interface" aria-labelledby="auth-heading" hidden>
        <h2 id="auth-heading">Authentication</h2>
        <p>Sign in to access your personalized ForgetfulMe settings.</p>
        <!-- Auth content loads here -->
      </section>
      
      <section id="settings-interface" aria-labelledby="settings-heading" hidden>
        <h2 id="settings-heading">Extension Settings</h2>
        <p>Customize your ForgetfulMe experience with these options.</p>
        
        <!-- Static structure for main settings sections -->
        <section id="status-settings" aria-labelledby="status-heading">
          <h3 id="status-heading">Custom Status Types</h3>
          <p>Add custom status types to organize your bookmarks.</p>
          <!-- Status settings content loads here -->
        </section>
        
        <section id="data-settings" aria-labelledby="data-heading">
          <h3 id="data-heading">Data Management</h3>
          <p>Import, export, or clear your ForgetfulMe data.</p>
          <!-- Data management content loads here -->
        </section>
        
        <section id="stats-section" aria-labelledby="stats-heading">
          <h3 id="stats-heading">Usage Statistics</h3>
          <p>View your ForgetfulMe usage statistics and insights.</p>
          <!-- Statistics content loads here -->
        </section>
      </section>
      
      <section id="error-interface" aria-labelledby="error-heading" hidden>
        <h2 id="error-heading">Configuration Error</h2>
        <p id="error-message">Unable to load settings. Please check your configuration.</p>
        <!-- Error content loads here -->
      </section>
    </main>

    <!-- ARIA live region for announcements -->
    <div id="status-announcements" aria-live="polite" aria-atomic="true" class="sr-only"></div>
    
    <!-- Load Supabase library -->
    <script src="supabase-js.min.js"></script>
    <!-- Load main options script -->
    <script src="options/index.js" type="module"></script>
  </body>
</html>
